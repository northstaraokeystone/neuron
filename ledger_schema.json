{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "NEURON v4.3 Ledger Entry (The Shared Nerve)",
  "description": "Triad-integrated ledger entry with multi-project support, system-wide alpha, and bio-silicon continuity",
  "type": "object",
  "required": ["ts", "project", "model", "task", "next", "hash", "salience", "replay_count", "energy", "token_count"],
  "properties": {
    "ts": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 UTC timestamp of entry creation"
    },
    "project": {
      "type": "string",
      "enum": ["agentproof", "axiom", "neuron", "grok", "human"],
      "description": "Source project identifier (v4.3: extended for triad)"
    },
    "event_type": {
      "type": "string",
      "enum": ["task", "eviction", "rollback", "discovery", "interrupt", "grok_eviction", "grok_reset", "agentproof_rollback", "agentproof_anchor", "axiom_law_discovery", "axiom_entropy_spike", "human_interrupt", "human_return", "unknown"],
      "default": "task",
      "description": "Type of event (v4.3: AI event types for auto-append)"
    },
    "model": {
      "type": "string",
      "enum": ["grok", "claude", "gemini", "neuron"],
      "description": "LLM model that generated this entry"
    },
    "commit": {
      "type": ["string", "null"],
      "description": "Git commit hash or null"
    },
    "task": {
      "type": "string",
      "maxLength": 50,
      "description": "Current task description (≤50 chars)"
    },
    "next": {
      "type": "string",
      "maxLength": 50,
      "description": "Next action description (≤50 chars)"
    },
    "hash": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}:[a-f0-9]{64}$",
      "description": "SHA256:BLAKE3 dual hash per CLAUDEME §8"
    },
    "salience": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "default": 1.0,
      "description": "Entry importance (0-1), decays over time, increases on replay"
    },
    "replay_count": {
      "type": "integer",
      "minimum": 0,
      "default": 0,
      "description": "Number of times entry was accessed during consolidation"
    },
    "energy": {
      "type": "number",
      "minimum": 0.5,
      "maximum": 2.0,
      "description": "Cognitive load estimate (higher = more complex context)"
    },
    "token_count": {
      "type": "integer",
      "minimum": 0,
      "default": 0,
      "description": "Context window utilization at append time"
    },
    "inference_id": {
      "type": ["string", "null"],
      "default": null,
      "description": "Unique identifier for inference cycle (e.g., inf_abc123)"
    },
    "context_summary": {
      "type": "string",
      "maxLength": 500,
      "default": "",
      "description": "Compressed snapshot of context (≤500 chars)"
    },
    "source_context": {
      "type": "object",
      "default": {},
      "description": "Optional metadata from source project (v4.3: triad context)"
    }
  },
  "additionalProperties": false
}
